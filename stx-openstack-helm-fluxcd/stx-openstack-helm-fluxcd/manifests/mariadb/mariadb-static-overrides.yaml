#
# Copyright (c) 2022 Wind River Systems, Inc.
#
# SPDX-License-Identifier: Apache-2.0
#

---
release_group: osh-openstack-mariadb
manifests:
  pod_test: false
monitoring:
  prometheus:
    enabled: false
labels:
  server:
    node_selector_key: openstack-control-plane
    node_selector_value: enabled
  prometheus_mysql_exporter:
    node_selector_key: openstack-control-plane
    node_selector_value: enabled
images:
  tags:
    image_repo_sync: null
    prometheus_mysql_exporter: null
    prometheus_mysql_exporter_helm_tests: null
    ks_user: docker.io/starlingx/stx-heat:master-centos-stable-latest
    mariadb: docker.io/openstackhelm/mariadb:ubuntu_xenial-20200303
    mariadb_backup: docker.io/openstackhelm/mariadb:10.2.18
    scripted_test: null
pod:
  probes:
    server:
      mariadb:
        readiness:
          enabled: true
        startup:
          enabled: true
        liveness:
          enabled: true
  affinity:
    anti:
      type:
        default: requiredDuringSchedulingIgnoredDuringExecution
  tolerations:
    mariadb:
      enabled: true
      tolerations:
      - key: node-role.kubernetes.io/master
        operator: Exists
        effect: NoSchedule
      - key: node-role.kubernetes.io/control-plane
        operator: Exists
        effect: NoSchedule
      - effect: NoExecute
        operator: Exists
      - key: openstack-compute-node
        operator: Exists
        effect: NoSchedule
  resources:
    enabled: true
    ingress:
      requests:
        ephemeral-storage: "500Ki"
conf:
  ingress_conf:
    worker-processes: '4'
  database:
    config_override: |
      [mysqld]
      wait_timeout=3600
      wsrep_provider_options="gmcast.listen_addr=tcp://0.0.0.0:{{ tuple "oslo_db" "direct" "wsrep" . | include "helm-toolkit.endpoints.endpoint_port_lookup" }}"
...
