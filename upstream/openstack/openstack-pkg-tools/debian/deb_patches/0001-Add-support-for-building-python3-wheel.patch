From 2a95d804c254e0490080fa8b7bf8fc9a3e4d5139 Mon Sep 17 00:00:00 2001
From: Romulo Leite <romulo.leite@windriver.com>
Date: Thu, 16 Jan 2025 11:46:33 -0300
Subject: [PATCH] Add support for building python3 wheel Author: Chuck Short
 <charles.short@windriver.com>

Signed-off-by: Romulo Leite <romulo.leite@windriver.com>
---
 build-tools/pkgos-dh_auto_install | 10 ++++++++++
 debian/control                    |  1 +
 2 files changed, 11 insertions(+)

diff --git a/build-tools/pkgos-dh_auto_install b/build-tools/pkgos-dh_auto_install
index f766f13..84ed1c2 100755
--- a/build-tools/pkgos-dh_auto_install
+++ b/build-tools/pkgos-dh_auto_install
@@ -18,6 +18,10 @@ for i in $@ ; do
 		PKGOS_IN_TMP=yes
 		shift
 		;;
++	"--wheel")
+		PKGOS_USE_WHEEL=yes
+		shift
+		;;
 	*)
 		;;
 	esac
@@ -36,5 +40,11 @@ fi
 for pyvers in ${PYTHON3S}; do
 	python${pyvers} setup.py install --install-layout=deb --root $(pwd)/debian/${TARGET_DIR}
 done
+if [ "${PKGOS_USE_WHEEL}" = "yes" ]; then
+	for pyvers in ${PYTHON3S}; do
+		python${pyvers} setup.py bdist_wheel --universal  -d $(pwd)/debian/python3-${PY_MODULE_NAME}-wheel/usr/share/python-wheel
+	done
+fi
+
 rm -rf $(pwd)/debian/python*/usr/lib/python*/dist-packages/*.pth
 rm -rf $(pwd)/debian/tmp/usr/lib/python*/dist-packages/*.pth
diff --git a/debian/control b/debian/control
index 8cb1b2d..70ed450 100644
--- a/debian/control
+++ b/debian/control
@@ -17,6 +17,7 @@ Architecture: all
 Multi-Arch: foreign
 Depends:
  python3-pip,
+ python3-wheel,
  gettext,
  jq,
  po-debconf,
-- 
2.34.1

